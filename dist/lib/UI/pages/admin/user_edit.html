[calc]
	$CGI->{no_dbmenu} = 1;
	$CGI->{access_menu} = 1;
	return;
[/calc]
[seti page_title]Administrator Edit: [cgi user_id][/seti]
[set ui_class]Admin[/set]
[seti page_banner]Administrator Edit: <B>[cgi user_id]</B>[/seti]
[set page_perm]access=v[/set]
[set help_name]admin.edit[/set]
[set icon_name]icon_config.gif[/set]
[calc]
	$CGI->{mv_data_table} = $Values->{mv_data_table} = '__UI_ACCESS_TABLE__'; 
	return;
[/calc]
@_UI_STD_HEAD_@
[if scratch ui_message]
<P>
<BLOCKQUOTE>
	[scratch ui_message][set ui_message][/set]
</BLOCKQUOTE>
<P>
&nbsp;
[/if]

[loop list="[cgi user_id]"]
<form action="[area ui]" method="post">
<INPUT TYPE=hidden NAME=mv_todo VALUE=back>
<INPUT TYPE=hidden NAME=mv_nextpage VALUE=__UI_BASE__/access>
<INPUT TYPE=hidden NAME=mv_data_table VALUE="[value mv_data_table]">
<INPUT TYPE=hidden NAME=mv_data_key VALUE="username">
<INPUT TYPE=hidden NAME=mv_update_empty VALUE="1">
<INPUT TYPE=hidden NAME=yes_tables VALUE="NONE">
<INPUT TYPE=hidden NAME=yes_functions VALUE="NONE">
<INPUT TYPE=hidden NAME=mv_data_fields VALUE="username name super groups yes_tables yes_functions">

<table __UI_T_PROPERTIES__>

<tr>
<td colspan=2 bgcolor=__UI_C_TOPBLOCKBAR__><img src="bg.gif" width=600 height=1></td>
</tr>

<input type="hidden" name="user_id" value="[cgi user_id]">
<tr>
<td bgcolor=__UI_C_INTBLOCK__ align=right>
<small>Real name</small>
</td>
<td bgcolor=__UI_C_INTBLOCK__>
<input type=text size=40 name=name maxlength=100 value="[filter entities][loop-data __UI_ACCESS_TABLE__ name][/filter]">
</td>
</tr>


<tr>
<td bgcolor=__UI_C_INTBLOCK__ align=right>
<small>User name</small>
</td>
<td bgcolor=__UI_C_INTBLOCK__>
[if cgi ui_hide_key]
	<input type=hidden name=mv_data_function value="update">
	<input type=hidden name=username value="[loop-code]">[loop-code]
[else]
	[if-mm !advanced access=c]
	[set ui_error]No permission to create user.[/set]
	[bounce page="__UI_BASE__/error"]
	[/set]
	[/if-mm]
	<input type=hidden name=mv_data_function value="insert">
	<input type=text size=40 name=username maxlength=100 value="[loop-code]">
[/else]
[/if]
</td>
</tr>

<tr>
<td bgcolor=__UI_C_INTBLOCK__ align=right>
<small>Super-user</small>
</td>
<td bgcolor=__UI_C_INTBLOCK__>
<INPUT type=checkbox name=super value=1 [if-loop-data __UI_ACCESS_TABLE__ super]checked[/if-loop-data]>
</td>
</tr>

<tr><td colspan=2 bgcolor=__UI_C_TOPBLOCKBAR__><img src="bg.gif" width=1 height=1></td></tr>

<tr>
<td bgcolor=__UI_C_INTBLOCK__ align=right>
<small>Groups</small>
</td>
<td bgcolor=__UI_C_INTBLOCK__>
[calc]
	$Values->{groups} = q{[loop-data __UI_ACCESS_TABLE__ groups]};
	$Values->{groups} =~ s/(\w+)/:$1/g;
	$Values->{groups} =~ s/\s+/\0/g;
	return;
[/calc]
<INPUT TYPE=hidden NAME=ui_filter:groups VALUE=null_to_space>
<select name=groups size=5 multiple>
[loop
	prefix=group
	multiple=1
	search="
		fi=__UI_ACCESS_TABLE__
		st=db
		co=yes
		se=:
		sf=username
		tf=name
		bs=yes
		ml=1000
	"
]<OPTION VALUE="[group-code]" [selected groups [group-code]]>[group-data __UI_ACCESS_TABLE__ name]
[/loop]
</select>
</td>
</tr>

<tr>
<td colspan=2 bgcolor=__UI_C_TOPBLOCKBAR__><img src="bg.gif" width=600 height=1></td>
</tr>

</table>

<p>

[if-mm advanced access=e]
	[button text=Ok]
		[calc]$CGI->{groups} =~ s/://g; return[/calc]
		mv_todo=set
	[/button]
	[button text=Permissions]
		mv_todo=back
		mv_nextpage=__UI_BASE__/access_permissions
	[/button]
	<input type=submit value="Cancel">
[else]
	[button text=Back]
	mv_todo=back
	[/button]
[/else]
[/if-mm]


</form>

[/loop]

@_UI_STD_FOOTER_@

<!-- page: @@MV_PAGE@@ -->
