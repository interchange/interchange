[set page_title]Shipping Configuration[/set]
[set ui_checklist]1[/set]
[set help_name]wizard.ups[/set]
@_UI_STD_HEAD_@

[perl]
	# use company ZIP for default if it's a standard US ZIP code
	$defaultshipzip = ($Values->{zip} =~ /^(\d{5})/) ? $1 : "";
	return;
[/perl]

<table><tr><td width=500>
Select the UPS shipping options you want to offer. In the <b>Handling
charge</b> field, enter the amount beyond the cost of shipping you want to
charge the customer for delivery. Enter this value as a decimal amount. For
example, enter 3.00 for a $3.00 handling charge.
</td></tr></table>

[seti ups_modes][available-www-shipping ups][/seti]
[calc]
	my @modes = split /\n/, $Scratch->{ups_modes};
	my @out;
	for (@modes) {
		s/^\w+://;
		s/\t\w+:/=/;
	}
	$Scratch->{ups_modes} = join ",\n", @modes;
	return;
[/calc]
[table-editor 
	table=variable
	left_width=120
	table_width=500
	wizard=1
	defaults=1
	bottom_buttons=1
	no_top=1
	no_bottom=1
   	row_template="[scratch row_template]"

	mv_nextpage=__UI_BASE__/wizard/step_pay
	mv_prevpage=__UI_BASE__/wizard/step_ship
	hidden.ui_return_to="__UI_BASE__/wizard/index"

	ui_data_key=code
	widget.code=text_10

	ui_data_fields="code shipzip upsmodes upsadder"
	ui_display_only="shipzip upsmodes upsadder"
	ui_hide_key="1"

	label.shipzip="Warehouse ZIP code"
	check.shipzip=zip
	help.shipzip="From what ZIP code will your shipments be sent? (Leave blank if not in U.S.)"
	widget.shipzip=text_5
	default.shipzip=`$defaultshipzip`

	label.upsmodes="UPS Options"
	check.upsmodes=mandatory
	help.upsmodes="The UPS delivery options you will allow?"
	widget.upsmodes=checkbox_left_2
	default.upsmodes="GNDCOM 2DA 1DA XPD XPR"
	passed.upsmodes=`$Scratch->{ups_modes}`
	filter.upsmodes="checkbox null_to_space"

	label.upsadder="Handling charge"
	filter.upsadder="digits_dot"
	check.upsadder="regex ^\\d+(?:\\.\\d+)?\$"
	help.upsadder="Handling/packaging cost to be added to raw UPS cost"
	widget.upsadder=text_8
	default.upsadder="3.00"
]

[set ui_override_next]
[perl]
	if($Values->{shipmethod} =~ /\bflat\b/i) {
		$CGI->{mv_nextpage} = '__UI_BASE__/wizard/step_ship_default';
	}
	delete $Scratch->{ui_override_next};
	return;
[/perl]
[/set]

@_UI_STD_FOOTER_@
