[set page_title][L]Shipping Preferences - UPS[/L][/set]
[set ui_checklist]1[/set]
[set help_name]wizard.ups[/set]
@_UI_STD_HEAD_@

[perl]
	# use company ZIP for default if it's a standard US ZIP code
	$defaultshipzip = ($Values->{zip} =~ /^(\d{5})/) ? $1 : "";
	return;
[/perl]

<p>
[L]Select the UPS shipping options you want to offer.[/L] 
<p>

[seti ups_modes][available-www-shipping ups][/seti]
[calc]
	my @modes = split /\n/, $Scratch->{ups_modes};
	my @out;
	for (@modes) {
		s/^\w+://;
		s/\t\w+:/=/;
	}
	$Scratch->{ups_modes} = join ",\n", @modes;
	return;
[/calc]
[table-editor 
	
	left_width=120
	table_width=500
	wizard=1
	defaults=1
	bottom_buttons=1
	no_top=1
	no_bottom=1
   	row_template="[scratch row_template]"

	mv_nextpage="[either][cgi ui_nextpage][or]__UI_BASE__/wizard/step_ship_country[/either]"
	mv_prevpage="[either][cgi ui_prevpage][or]__UI_BASE__/wizard/step_ship[/either]"
	hidden.ui_return_to="__UI_BASE__/wizard/index"

	ui_wizard_fields="shipzip upsmodes upsadder"

	label.shipzip="[L]Warehouse ZIP code[/L]"
	check.shipzip=zip
	help.shipzip="[L]From what ZIP code will your shipments be sent? (Leave blank if not in U.S.)[/L]"
	widget.shipzip=text_5
	default.shipzip=`$defaultshipzip`

	label.upsmodes="[L]UPS Options[/L]"
	check.upsmodes=mandatory
	help.upsmodes="[L]Which UPS delivery options will you allow?[/L]"
	widget.upsmodes=checkbox_left_2
	default.upsmodes="GNDCOM 2DA 1DA XPD XPR"
	passed.upsmodes=`$Scratch->{ups_modes}`
	filter.upsmodes="checkbox null_to_space"

	label.upsadder="[L]Handling charge[/L]"
	filter.upsadder="digits_dot"
	check.upsadder="regex ^\d+(?:\.\d+)?$"
	help.upsadder="[L]Handling/packaging cost to be added to raw UPS cost[/L]"
	widget.upsadder=text_8
	default.upsadder="3.00"
]

[set ui_override_next]
[perl]
	if($Values->{shipmethod} =~ /\bflat\b/i) {
		$CGI->{mv_nextpage} = '__UI_BASE__/wizard/step_ship_default';
	}
	delete $Scratch->{ui_override_next};
	return;
[/perl]
[/set]

@_UI_STD_FOOTER_@
