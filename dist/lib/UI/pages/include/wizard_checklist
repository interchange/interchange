<!-- start wizard checklist -->
[if cgi mv_todo ne back]
[update values]
[/if]

[include include/wizard_profiles]

<table border=0 cellspacing=0 cellpadding=7>
<tr>
<td width="215" valign=top>
	<table border=0 cellspacing=0 cellpadding=1 width="100%">
	<tr>
	<td bgcolor="#000000" valign=top>
		<table border=0 cellspacing=0 cellpadding=1 bgcolor=white>
[loop search="
	fi=@_UI_MENU_TABLE_@
	se=Wizard
	sf=mgroup
	co=yes
	op=eq
	tf=msort
	rf=page,name,indicator,next_line,help_name
"]
[loop-sub fig_box]
	shift;
	my ($page, $name, $indicator, $next_line, $help_name) = @{shift || []};
	my $current = q{@@MV_PAGE@@};
	my $imgbase = q{@_UI_IMG_@admin/};
	
	my $complete = $Tag->run_profile($indicator);

	my $bgcolor;
	my $img = 'box_empty.gif';
	if($current =~ /^$page/) {
		$bgcolor = '#99CCFF';
	}
	if ($complete) {
		$bgcolor = '#CCCCCC' unless $bgcolor;
		$img = 'box_checked.gif';
	}
	else {
		$bgcolor = '#FFFFFF' unless $bgcolor;
	}

	my $url = $Tag->area({
						href => $page,
						form => qq{
					  		page_title=$name
					  		help_name=$help_name
						},
					});
	if($next_line) {
		return <<EOF;
<tr>
	<td bgcolor="$bgcolor" width="1%">&nbsp;</td>
	<td bgcolor="$bgcolor"><img src="$imgbase$img" width="15" height="15" alt="" border="0"></td>
	<td bgcolor="$bgcolor" width="98%"><a href="$url" class="flowchart"><font size=-1>$name</a></td>
</tr>
EOF
	}
	else {
		return <<EOF;
<tr>
	<td bgcolor="$bgcolor"><img src="$imgbase$img" width="15" height="15" alt="" border="0"></td>
	<td bgcolor="$bgcolor" width="98%" colspan=2><a href="$url" class="flowchart"><font size=-1>$name</a></td>
</tr>
EOF
	}
[/loop-sub]
[loop-exec fig_box][/loop-exec]
[/loop]
	</table>
	</td>
	</tr>
</table>

<p>
[page href="@@MV_PAGE@@" form="
	mv_action=back
	mv_click=profile_save_values
"]Save current settings</A>

[if type=file term=`
	$Scratch->{wizard_fn} = "upload/$Session->{username}.wizard";
`]
	<BR>[page href="@@MV_PAGE@@" form="
		mv_action=back
		mv_click=profile_get_values
	"]Retrieve saved values</A>
[/if]
</p>
[if type=explicit compare="__MV_DEMO_MODE__"]
<p>(For testing convenience:)<br>
[page __UI_BASE__/wizard/demo_init]Set some starting values</A><br>
[page __UI_BASE__/wizard/demo_zero]Zero the values</A></p>
[/if]

</td>
<td valign=top>

[set row_template]
	<td class=clabel width="~OPT:left_width~"> 
		~BLABEL~$LABEL$~ELABEL~
	</td>
	<td class=cwidget> 
		<table cellspacing=0 cellmargin=0 width="100%">
			<tr> 
				<td class=cwidget> 
					$WIDGET$
				</td>
			</tr>
		</table>
	</td>
[/set]
<!-- end wizard checklist -->
